
# ğŸŒ¾ AgroTrace - Architecture Microservices

## ğŸ“‹ Table des matiÃ¨res

1. [Vue d'ensemble](#vue-densemble)
2. [Architecture globale](#architecture-globale)
3. [Flux de donnÃ©es](#flux-de-donnÃ©es)
4. [Infrastructure](#infrastructure)
5. [Base de donnÃ©es](#base-de-donnÃ©es)
6. [Kafka Topics](#kafka-topics)
7. [VÃ©rifications](#verifications)

> ğŸ“˜ **Documentation des Microservices** : Voir [MICROSERVICES.md](./MICROSERVICES.md)

---

## ğŸ¯ Vue d'ensemble

**AgroTrace** est une plateforme IoT et IA pour l'agriculture de prÃ©cision utilisant une architecture microservices.

### Composants principaux

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AGROTRACE ECOSYSTEM                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“¡ SOURCES DE DONNÃ‰ES
    â”œâ”€â”€ Capteurs IoT (tempÃ©rature, humiditÃ©, sol)
    â””â”€â”€ Drones UAV (images aÃ©riennes)

âš™ï¸  MICROSERVICES
    â”œâ”€â”€ MS0: Simulateur de Capteurs
    â”œâ”€â”€ MS1: Ingestion Capteurs
    â”œâ”€â”€ MS2: PrÃ©traitement (Sensors + Images UAV)
    â””â”€â”€ MS3: VisionPlante (DÃ©tection maladies IA)

ğŸ—„ï¸  INFRASTRUCTURE
    â”œâ”€â”€ Apache Kafka (bus de messages)
    â”œâ”€â”€ TimescaleDB (sÃ©ries temporelles)
    â”œâ”€â”€ MinIO (stockage objets S3)
    â””â”€â”€ Docker (conteneurisation)

ğŸ“Š CLIENTS
    â”œâ”€â”€ Dashboard temps rÃ©el (Ã  venir)
    â”œâ”€â”€ API REST (Ã  venir)
    â””â”€â”€ Alertes automatiques (Ã  venir)
```

---

## ğŸ—ï¸ Architecture globale

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ARCHITECTURE COMPLÃˆTE                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   SIMULATEUR        â”‚
                        â”‚   CAPTEURS          â”‚
                        â”‚   (MS0)             â”‚
                        â”‚                     â”‚
                        â”‚ - GÃ©nÃ¨re donnÃ©es    â”‚
                        â”‚ - Format JSON       â”‚
                        â”‚ - Intervalle: 2s    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ Publie
                                   â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   APACHE KAFKA      â”‚
                        â”‚                     â”‚
                        â”‚ Topic:              â”‚
                        â”‚ "sensor-data"       â”‚
                        â”‚                     â”‚
                        â”‚ RÃ©tention: 7 jours  â”‚
                        â”‚ Partitions: 2       â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                  â”‚                  â”‚
                â–¼                  â–¼                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚   INGESTION         â”‚  â”‚   PRÃ‰TRAITEMENT     â”‚ â”‚
    â”‚   CAPTEURS          â”‚  â”‚   (MS2)             â”‚ â”‚
    â”‚   (MS1)             â”‚  â”‚                     â”‚ â”‚
    â”‚                     â”‚  â”‚ SENSORS:            â”‚ â”‚
    â”‚ - Validation        â”‚  â”‚ - Nettoyage         â”‚ â”‚
    â”‚ - Harmonisation     â”‚  â”‚ - Normalisation     â”‚ â”‚
    â”‚ - Stockage brut     â”‚  â”‚ - Anomalies         â”‚ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                     â”‚ â”‚
               â”‚             â”‚ IMAGES UAV:         â”‚ â”‚
               â”‚             â”‚ - Segmentation      â”‚ â”‚
               â”‚             â”‚ - Corrections       â”‚ â”‚
               â”‚             â”‚ - NDVI              â”‚ â”‚
               â–¼             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚            â”‚
    â”‚   TIMESCALEDB       â”‚            â”‚            â”‚
    â”‚                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚ Table:              â”‚  â”‚         â”‚          â”‚ â”‚
    â”‚ sensor_data         â”‚  â–¼         â–¼          â”‚ â”‚
    â”‚                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
    â”‚ (DonnÃ©es brutes)    â”‚  â”‚  TIMESCALEDB     â”‚ â”‚ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  Table:          â”‚ â”‚ â”‚
                             â”‚  sensor_data_    â”‚ â”‚ â”‚
                             â”‚  processed       â”‚ â”‚ â”‚
                             â”‚  (TraitÃ©es)      â”‚ â”‚ â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
                                      â”‚           â”‚ â”‚
                                      â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”˜ â”‚
                                      â”‚    â”‚        â”‚
                                      â”‚    â–¼        â”‚
                                      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚  â”‚   MINIO         â”‚
                                      â”‚  â”‚  Buckets:       â”‚
                                      â”‚  â”‚  - raw-uav-     â”‚
                                      â”‚  â”‚    images       â”‚
                                      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚           â”‚
                                      â–¼           â–¼
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚   APACHE KAFKA          â”‚
                             â”‚                         â”‚
                             â”‚ Topics:                 â”‚
                             â”‚ - sensor-data-processed â”‚
                             â”‚ - image.uploaded        â”‚
                             â”‚ - disease.detected      â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚
                                         â–¼
                                  (Pour futurs MS)
```

---

## ğŸ”„ Flux de donnÃ©es dÃ©taillÃ©

### Phase 1 : GÃ©nÃ©ration et Ingestion

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1 : GÃ‰NÃ‰RATION ET INGESTION DES DONNÃ‰ES                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Temps: T+0s
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MS0: Simulateur     â”‚
â”‚ - Lit Dataset CSV   â”‚
â”‚ - GÃ©nÃ¨re donnÃ©es    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ Toutes les 2 secondes
           â–¼
ğŸ“¤ Publication Kafka
{
  "sensor_type": "Environment Temperature",
  "timestamp": "2025-12-02T10:30:00Z",
  "data_index": 42,
  "measurements": {
    "Temperature (Â°C)": 25.3
  },
  "created_at": "2025-12-02T10:30:00Z"
}
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kafka Topic:        â”‚
â”‚ "sensor-data"       â”‚
â”‚                     â”‚
â”‚ - Message en file   â”‚
â”‚ - Disponible pour   â”‚
â”‚   tous consumers    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                                 â”‚
           â–¼                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MS1: Ingestion      â”‚          â”‚ MS2: PrÃ©traitement  â”‚
â”‚                     â”‚          â”‚                     â”‚
â”‚ Consumer Group:     â”‚          â”‚ Consumer Group:     â”‚
â”‚ "ingestion-group"   â”‚          â”‚ "preprocessing-     â”‚
â”‚                     â”‚          â”‚  group"             â”‚
â”‚ âœ“ Consomme msg      â”‚          â”‚ âœ“ Consomme msg      â”‚
â”‚ âœ“ Valide format     â”‚          â”‚ (mÃªme message)      â”‚
â”‚ âœ“ Insert DB         â”‚          â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                â”‚
           â–¼ T+1s                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚ TimescaleDB         â”‚                    â”‚
â”‚ Table:              â”‚                    â”‚
â”‚ sensor_data         â”‚                    â”‚
â”‚                     â”‚                    â”‚
â”‚ INSERT INTO         â”‚                    â”‚
â”‚ sensor_data(...)    â”‚                    â”‚
â”‚ VALUES(...)         â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                                           â”‚
                                           â–¼ T+2s
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ MS2 : TRAITEMENT                 â”‚
                    â”‚                                  â”‚
                    â”‚ 1. Extraction valeur             â”‚
                    â”‚    raw_value = 25.3              â”‚
                    â”‚                                  â”‚
                    â”‚ 2. DÃ©tection anomalie            â”‚
                    â”‚    Z-score < 3.0 â†’ OK            â”‚
                    â”‚                                  â”‚
                    â”‚ 3. Nettoyage                     â”‚
                    â”‚    clean_value = 25.3            â”‚
                    â”‚                                  â”‚
                    â”‚ 4. Normalisation [0-1]           â”‚
                    â”‚    normalized = (25.3+10)/60     â”‚
                    â”‚                = 0.588           â”‚
                    â”‚                                  â”‚
                    â”‚ 5. Moyenne mobile                â”‚
                    â”‚    moving_avg = 25.45            â”‚
                    â”‚                                  â”‚
                    â”‚ 6. Score qualitÃ©                 â”‚
                    â”‚    quality_score = 1.0           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                  â”‚
                    â–¼ T+3s                             â–¼ T+3s
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ TimescaleDB         â”‚          â”‚ Kafka Topic:        â”‚
         â”‚ Table:              â”‚          â”‚ "sensor-data-       â”‚
         â”‚ sensor_data_        â”‚          â”‚  processed"         â”‚
         â”‚ processed           â”‚          â”‚                     â”‚
         â”‚                     â”‚          â”‚ Message:            â”‚
         â”‚ INSERT INTO         â”‚          â”‚ {                   â”‚
         â”‚ sensor_data_        â”‚          â”‚   "sensor_type":    â”‚
         â”‚ processed(...)      â”‚          â”‚   "...",            â”‚
         â”‚ VALUES(...)         â”‚          â”‚   "raw_value": 25.3,â”‚
         â”‚                     â”‚          â”‚   "clean_value":    â”‚
         â”‚ âœ… StockÃ©           â”‚          â”‚    25.3,            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   "normalized":     â”‚
                                          â”‚    0.588,           â”‚
                                          â”‚   "quality": 1.0    â”‚
                                          â”‚ }                   â”‚
                                          â”‚                     â”‚
                                          â”‚ âœ… PubliÃ© pour      â”‚
                                          â”‚    futurs MS        â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 2 : Traitement Images UAV

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2 : TRAITEMENT IMAGES UAV                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Temps: T+0s
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Upload externe      â”‚
â”‚ vers MinIO          â”‚
â”‚ (API/Console Web)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MinIO               â”‚
â”‚ Bucket:             â”‚
â”‚ "raw-uav-images"    â”‚
â”‚                     â”‚
â”‚ field001/           â”‚
â”‚  â””â”€ 2024-01-15/     â”‚
â”‚     â””â”€ ortho.tif    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Trigger notification
           â–¼
ğŸ“¤ Publication Kafka "image.uploaded"
{"event_type":"image_uploaded",
 "bucket":"raw-uav-images",
 "object_name":"field001/2024-01-15/ortho.tif",
 "field_id":"field001"}
           â”‚
           â–¼ T+1s
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MS3: VisionPlante   â”‚
â”‚ (Disease Detection) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ T+2s
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MS3 : DÃ‰TECTION MALADIES           â”‚
â”‚ 1. Download image MinIO            â”‚
â”‚ 2. Preprocessing (EfficientNet-B2) â”‚
â”‚ 3. InfÃ©rence IA (14 classes)       â”‚
â”‚ 4. Classification maladie          â”‚
â”‚ 5. Top-5 prÃ©dictions + confiance   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          â”‚             â”‚
â–¼ T+3s     â–¼ T+3s        â–¼ T+3s
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kafka Topic:     â”‚  â”‚ MinIO       â”‚  â”‚ Alertes/Actions  â”‚
â”‚ "disease.        â”‚  â”‚ "disease-   â”‚  â”‚ (Ã  venir)        â”‚
â”‚  detected"       â”‚  â”‚  detection- â”‚  â”‚                  â”‚
â”‚                  â”‚  â”‚  results"   â”‚  â”‚ - Email alerte   â”‚
â”‚ {"predicted_     â”‚  â”‚             â”‚  â”‚ - Dashboard      â”‚
â”‚   class":        â”‚  â”‚ results/    â”‚  â”‚ - Recommandationsâ”‚
â”‚  "Apple___       â”‚  â”‚  â””â”€ img.jsonâ”‚  â”‚                  â”‚
    â”‚   Apple_scab",   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚  "confidence":   â”‚
    â”‚   0.9823}        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Infrastructure

### Apache Kafka

**RÃ´le**: Bus de messages asynchrone

```
Topics actifs:
  * sensor-data           (donnÃ©es capteurs brutes)
  * sensor-data-processed (donnÃ©es capteurs traitÃ©es)
  * image.uploaded        (notifications upload images UAV)
  * disease.detected      (rÃ©sultats dÃ©tection maladies)

Dashboard: http://localhost:8080
```

### TimescaleDB

**RÃ´le**: Base de donnÃ©es sÃ©ries temporelles

```
Tables:
1. sensor_data (donnÃ©es brutes)
2. sensor_data_processed (donnÃ©es nettoyÃ©es)

Port: 5432
```

### MinIO

**RÃ´le**: Stockage objets S3-compatible pour images UAV

```
Ports:
  * 9000: API S3
  * 9001: Console Web

Buckets:
1. raw-uav-images             (images UAV originales)
2. disease-detection-results  (rÃ©sultats dÃ©tection maladies)

AccÃ¨s Console: http://localhost:9001
Login: minioadmin / minioadmin
```

---

## ğŸ” VÃ©rifications

### TimescaleDB

Dans `Docker desktop`, dans la tab Exec :
```
psql -U agrotrace_user -d agrotrace
```

Pour afficher les tables existantes :
```
\dt
```
 Puis utilise les commandes sql basiques